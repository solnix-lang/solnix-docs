# Execve Filename Monitor

Monitor every process execution and capture the filename being executed via ring buffers.

---

## Source

```snx
map events {
    type: .ringbuf;
    max: 16777216; // 1 << 24
}

event exec_event {
    pid: u32;
    filename: bytes[256];
}

unit trace_exec_filename {
    section: "tracepoint/syscalls/sys_enter_execve";
    license: "GPL";

    reg pid_tgid = ctx.get_pid_tgid();
    reg pid = pid_tgid;

    // In sys_enter_execve, filename pointer is at offset 16
    reg filename_ptr = ctx.load_u64(16);
    
    heap evt = events.reserve(exec_event);

    if guard(evt) {
        evt.pid = pid;
        ctx.probe_read_user_str(evt.filename, 256, filename_ptr);
        events.submit(evt);
    }

    return 0;
}
```

---

## Demonstrates

- `tracepoint` hooks
- `ctx` helpers (`get_pid_tgid`, `load_u64`)
- `ringbuf` maps for high-performance streaming
- `event` structures
- `probe_read_user_str` for safe memory access
